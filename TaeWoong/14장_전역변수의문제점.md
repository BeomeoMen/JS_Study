# 2023-08-26[토] 14장 : 전역변수의 문제점

## 14.1 변수의 생명 주기


> 지역 변수의 생명 주기
> 
- 지역 변수의 생명 주기는 함수의 생명 주기와  일치한다.

```jsx
var x = 'global';

function foo() {
	console.log(x); // undefined
	var x = 'local' // -> 함수 내부에서 호이스팅되어 스코프의 선두로 끌어올려진 것처럼 동작
	return x;
}

foo();
console.log(x); // global
```

> 전역 변수의 생명  주기
> 
- var 키워드로 선언한 전역 변수의 생명 주기는 `전역 객체의 생명 주기`와 일치한다.
- 브라우저 환경에서 `전역 객체는 window`이므로 var 키워드로 선언한 전역 변수는 window의 프로퍼티이다.
- `전역 객체인 window는 웹페이지를 닫기 전까지 유효`

## 14.2 전역 변수의 문제점

> 암묵적 결합
> 
- 전역 변수를 선언한 의도는  모든 코드가 전역 변수를 참고하고 변겨할 수 있는 `암묵적 결합`을 허용한 것
- 변수는 유효범위가 클수록 `코드의 가독성`이 나빠지고 `위험성`이 높아진다.

> 긴 생명 주기
> 
- 전역 변수의 생명주기는 `전역 객체인 window와 같으므로 상당히 길다.`
- `메모리의 리소스`도 오랜 기간 소비한다.
- 전역 변수의 상태를 변경할 시간이 길고 기회도 많다.

> 스코프 체인 상에서 종점에 존재
> 
- 스코프 체인 상에서 종점에 존재
    - 자바스크립트 엔진은 스코프 체인을 통해 변수를 참조하는 코드의 스코프에서 시작하여 상위 스코프 방향으로 이동하며 선언된 변수를 검색
- 전역 변수는 전역 객체의 프로퍼티이므로 종점에 존재
    - 전역 변수의 검색 속도가 가장 느리다.

> 네임스페이스의 오염
> 
- 자바스크립트의 가장 큰 문제점
    - 파일이 분리되어 있어도 하나의 전역 스코프를 공유한다.
- 다른 파일 내에서 동일한 이름으로 명명된 전역 변수나 전역 함수가 같은 스코프 내에 존재할 경우 예상치 못한 결과

## 14.3 전역 변수의 사용을 억제하는 방법

- 전역 변수를 반드시 사용해야 할 이유를 찾지 못했다면 지역 변수를 사용해라
- 변수의 스코프는 좁을수록 좋다.

> 즉시 실행 함수
> 
- 모든 코드를 즉시 실행 함수로 감싸면 모든 변수는 즉시 실행 함수의 지역 변수가 된다.
- 라이브러리 등에 자주 이용

> 네임스페이스 객체
> 
- 전역에 네임스페이스 역할을 담당할 객체를 생성하고 변수처럼 사용하고 싶은 변수를 프로퍼티로 추가하는 방법
- 그다지 유용하지 않음

> 모듈 패턴
> 
- 대부분의 객체지향 프로그래밍 언어는 클래스를 구성하는 멤버에 대해 `public, private, protected`  등의 접근 제한자를 사용
- 자바스크립트는 접근 제한자를 제공하지 않기 때문에 `정보 은닉`을 구현하기 위해 사용

```jsx
var Counter = (function () {
	//private 변수
	var num = 0;
	
	// 외부로 공개할 데이터나 메서드를 프로퍼티로 추가한 객체를 반환
	return {
		increase() {
			return ++num;
		},
		decrease() {
			return --num;
		}
	};
}());

//private 변수는 외부로 노출x
console.log(Counter.num); // undefined

console.log(Counter.increase()); // 1
console.log(Counter.increase()); // 2
console.log(Counter.decrease()); // 1
console.log(Counter.decrease()); // 0

```

- 외부에 노출하고 싶은 변수나 함수는 객체 담아 return으로 반환
    - 이때 반환된 객체의 프로퍼티는 `public member`
- 외부에 노출하고 싶지 않는 변수나 함수는 객체에 추가하지 않는다.
    - 객체에 추가하지 않으면 `private member`

> ES6 모듈
> 
- ES6 모듈은 파일 자체의 독자적인 모듈 스코프를 제공
    - export {};